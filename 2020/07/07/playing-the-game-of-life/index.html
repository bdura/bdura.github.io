<!doctype html>

<html lang="en">

	<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Basile Dura — Playing the game of life</title>

  
    <meta name="description" content="Can we understand what independent agents learn to optimise in a purely evolutionary setting?
" />
  

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <!-- bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <!-- CSS -->
  <link href="//fonts.googleapis.com/css?family=Antic+Slab|Fira+Sans" rel="stylesheet">
  <link rel="stylesheet" media="screen" href="/assets/css/screen.css">

  

  <!-- Icon -->
  <link rel="icon" type="image/png" href="/assets/images/favicon.png">

  <!-- Prism -->
  <link rel="stylesheet"
      href="/assets/css/prism.css">
  <script src="/assets/js/prism.js"></script>

  <!-- MathJax -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script"
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
  </script>

  <!-- Lodash -->
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.20/lodash.min.js"></script>

  <!-- Pseudocode -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
  <script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js">
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-172908572-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-172908572-1');
  </script>

</head>


	<body>

		<div style="display:none">
  
  $$
  \usepackage{algorithm}
  \usepackage{algorithmic}

  \newcommand{\indic}{\mathbbm{1}}

  \newcommand{\argmax}{\operatorname*{arg\,max}}
  \newcommand{\argmin}{\operatorname*{arg\,min}}
  \newcommand{\norm}[1]{\left\lVert#1\right\rVert}

  \newcommand{\Var}{\mathbb{V}\textrm{ar}}
  \newcommand{\Cov}{\mathbb{C}\textrm{ov}}

  \newcommand{\Id}{\bm{\textrm{Id}}}

  \newcommand{\E}{\mathbb{E}}
  \newcommand{\R}{\mathbb{R}}
  \newcommand{\N}{\mathbb{N}}
  \newcommand{\C}{\mathbb{C}}
  \newcommand{\Q}{\mathbb{Q}}
  \newcommand{\Z}{\mathbb{Z}}

  \newcommand{\LP}{\left(}
  \newcommand{\RP}{\right)}
  \newcommand{\LB}{\left[}
  \newcommand{\RB}{\right]}
  \newcommand{\LC}{\left\{}
  \newcommand{\RC}{\right\}}
  \newcommand{\RM}{\right|}
  \newcommand{\LM}{\left|}
  \newcommand{\MM}{\middle|}

  \renewcommand{\P}{\mathbb{P}}

  \newcommand{\define}{\stackrel{\mathrm{def}}{=}}
  \newcommand{\iid}{\stackrel{\mathrm{iid}}{\sim}}

  \newcommand{\rfrac}[2]{{}^{#1}\!/_{#2}}

  \newcommand{\pderiv}[2]{\frac{\partial #1}{\partial #2}}

  \newenvironment{theorem}[2][Theorem]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{lemma}[2][Lemma]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{exercise}[2][Exercise]{
  \begin{trivlist}\pdfbookmark{#1 #2}{#1-#2}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}\vspace{5mm}}
  \newenvironment{question}[2][Question]{
  \begin{trivlist}\pdfbookmark{#1 #2}{#1-#2}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}\vspace{5mm}}
  \newenvironment{reflection}[2][Reflection]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{proposition}[2][Proposition]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{corollary}[2][Corollary]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

  % Integral 'd'
  \def\diff{{\mathrm{d}}}

  % Vectors
  \def\vzero{{\bm{0}}}
  \def\vone{{\bm{1}}}
  \def\vmu{{\bm{\mu}}}
  \def\vtheta{{\bm{\theta}}}
  \def\va{{\bm{a}}}
  \def\vb{{\bm{b}}}
  \def\vc{{\bm{c}}}
  \def\vd{{\bm{d}}}
  \def\ve{{\bm{e}}}
  \def\vf{{\bm{f}}}
  \def\vg{{\bm{g}}}
  \def\vh{{\bm{h}}}
  \def\vi{{\bm{i}}}
  \def\vj{{\bm{j}}}
  \def\vk{{\bm{k}}}
  \def\vl{{\bm{l}}}
  \def\vm{{\bm{m}}}
  \def\vn{{\bm{n}}}
  \def\vo{{\bm{o}}}
  \def\vp{{\bm{p}}}
  \def\vq{{\bm{q}}}
  \def\vr{{\bm{r}}}
  \def\vs{{\bm{s}}}
  \def\vt{{\bm{t}}}
  \def\vu{{\bm{u}}}
  \def\vv{{\bm{v}}}
  \def\vw{{\bm{w}}}
  \def\vx{{\bm{x}}}
  \def\vy{{\bm{y}}}
  \def\vz{{\bm{z}}}

  % Matrix
  \def\mA{{\bm{A}}}
  \def\mB{{\bm{B}}}
  \def\mC{{\bm{C}}}
  \def\mD{{\bm{D}}}
  \def\mE{{\bm{E}}}
  \def\mF{{\bm{F}}}
  \def\mG{{\bm{G}}}
  \def\mH{{\bm{H}}}
  \def\mI{{\bm{I}}}
  \def\mJ{{\bm{J}}}
  \def\mK{{\bm{K}}}
  \def\mL{{\bm{L}}}
  \def\mM{{\bm{M}}}
  \def\mN{{\bm{N}}}
  \def\mO{{\bm{O}}}
  \def\mP{{\bm{P}}}
  \def\mQ{{\bm{Q}}}
  \def\mR{{\bm{R}}}
  \def\mS{{\bm{S}}}
  \def\mT{{\bm{T}}}
  \def\mU{{\bm{U}}}
  \def\mV{{\bm{V}}}
  \def\mW{{\bm{W}}}
  \def\mX{{\bm{X}}}
  \def\mY{{\bm{Y}}}
  \def\mZ{{\bm{Z}}}
  \def\mBeta{{\bm{\beta}}}
  \def\mPhi{{\bm{\Phi}}}
  \def\mLambda{{\bm{\Lambda}}}
  \def\mSigma{{\bm{\Sigma}}}

  % Caligraphy
  \def\calA{{\mathcal{A}}}
  \def\calB{{\mathcal{B}}}
  \def\calC{{\mathcal{C}}}
  \def\calD{{\mathcal{D}}}
  \def\calE{{\mathcal{E}}}
  \def\calF{{\mathcal{F}}}
  \def\calG{{\mathcal{G}}}
  \def\calH{{\mathcal{H}}}
  \def\calI{{\mathcal{I}}}
  \def\calJ{{\mathcal{J}}}
  \def\calK{{\mathcal{K}}}
  \def\calL{{\mathcal{L}}}
  \def\calM{{\mathcal{M}}}
  \def\calN{{\mathcal{N}}}
  \def\calO{{\mathcal{O}}}
  \def\calP{{\mathcal{P}}}
  \def\calQ{{\mathcal{Q}}}
  \def\calR{{\mathcal{R}}}
  \def\calS{{\mathcal{S}}}
  \def\calT{{\mathcal{T}}}
  \def\calU{{\mathcal{U}}}
  \def\calV{{\mathcal{V}}}
  \def\calW{{\mathcal{W}}}
  \def\calX{{\mathcal{X}}}
  \def\calY{{\mathcal{Y}}}
  \def\calZ{{\mathcal{Z}}}

  \def\normal{{\mathcal{N}}}

  \newcommand{\Dtrain}{{D_{\mathrm{train}}}}
  \newcommand{\Dvalid}{{D_{\mathrm{valid}}}}
  \newcommand{\Dtest}{{D_{\mathrm{test}}}}

  \newcommand{\Dtraint}{{D_{\mathrm{train}}^t}}
  \newcommand{\Dvalidt}{{D_{\mathrm{valid}}^t}}
  \newcommand{\Dtestt}{{D_{\mathrm{test}}^t}}

  \newcommand{\Dmeta}{{\mathcal{D}^\mathrm{meta}}}
  \newcommand{\Dmtrain}{{\mathcal{D}_\mathrm{train}^\mathrm{meta}}}
  \newcommand{\Dmvalid}{{\mathcal{D}_\mathrm{valid}^\mathrm{meta}}}
  \newcommand{\Dmtest}{{\mathcal{D}_\mathrm{test}^\mathrm{meta}}}

  \newcommand{\Dsupport}{{D_{\mathrm{support}}^t}}
  \newcommand{\Dquery}{{D_{\mathrm{query}}^t}}

  \newcommand{\loss}{\ell}
  \newcommand{\metaloss}{\mathcal{L}}

  \newcommand{\kr}{\mathrm{KR}}
  \newcommand{\kernel}{\mathrm{k}}
  \newcommand{\km}{\mathbf{K}}
  $$
  
</div>


		<nav>
	
	

		
		<a href="


  

/
" class="">
			Home
		</a>
	
	

		
		<a href="


  

/themes/
" class="">
			Themes
		</a>
	
	

		
		<a href="


  

/about/
" class="">
			About
		</a>
	

	<!-- 
		

		

		<a href="
			
				https://courses.bdura.me
			
		" class="">
			Courses
		</a>
	
		

		

		<a href="
			
				https://recettes.bdura.me/en/
			
		" class="">
			Recipes
		</a>
	 -->

	<div class="dropdown">
  <a class=" dropdown-toggle" type="button" id="dropdownMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Other
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdownMenu">
		
			

			

			<a href="
				
					https://courses.bdura.me
				
			" class="dropdown-item ">
				Courses
			</a>
		
			

			

			<a href="
				
					https://recettes.bdura.me/en/
				
			" class="dropdown-item ">
				Recipes
			</a>
		
  </div>
</div>

</nav>


		<div class="container main-content">

			<!-- <header>
	<div class="text-center">
		<a href="">
			<img src="/assets/images/author.png" alt="logo" style="border-radius: 50%;">
		</a>
	</div>
</header> -->

<div class="row">
	<div class="col-12 col-lg-2"></div>

	<div class="col-12 col-lg-8">
		<section class="content">



<article class="post">

	<div class="post-header">
	<h1>
		<a href="/2020/07/07/playing-the-game-of-life/">
			Playing the game of life
		</a>
	</h1>
	<time datetime="2020-07-07 00:00:00 +0000">
		<!-- July 7, 2020 -->
		July 7, 2020
	</time>
</div>


	<div class="image">
		<img src="https://source.unsplash.com/W7L6KCaNfRU" alt="Playing the game of life" class="img-fluid">
	</div>

	<div class="post-body">
		<p>This project was inspired by Blaise Aguera’s <a href="https://slideslive.com/38922302/social-intelligence">invited talk at NeurIPS 2019</a>.</p>

<p>What does an evolutionary strategy optimise?
The answer might seem obvious: it’s just <em>survival of the fittest</em>. But consider the case where the fitness function is not explicitly defined… Think of Life itself: what objective are we or any living species implicitly optimising?</p>

<p>To give some intuition on what the answer might be, we will study a (hopefully) life-like model for a colony of bacteria, learning to survive in a harsh environment using a purely evolutionary approach. Depending on the action they take, the bacteria might die rapidly, killing off their genetic material, or on the contrary thrive and reproduce, passing their genome on to the next generation.</p>

<p>In the end, the “best performing” genome will take over the entire population. Something has been optimised, but what? To answer that question, we will use an indirect strategy.
<!-- Instead of equating genomes with behaviours, we will instead use the genetic material to define the objective itself. --></p>

<!-- Then, we try to understand what is actually being optimised by the evolution process. -->

<h2 id="playing-the-game">Playing the game</h2>

<p>In our model, agents are single-cell bacteria that need energy to thrive, lest they die of exhaustion. They start out with an energy level of 1/2, die if they reach 0 and reproduce if they reach 1, passing on their genetic material to their offspring.</p>

<p>At each time step, using information from their local environment, each bacterium can choose to perform one of two basic actions:</p>
<ul>
  <li>“Run”, ie go straight;</li>
  <li>“Tumble”, ie randomise its direction.</li>
</ul>

<figure class="figure ided text-center" id="figure1">
  <a data-toggle="modal" data-target="#figureModal1">
  <img src="https://docs.google.com/drawings/d/e/2PACX-1vQnPoOyX5pvzlugkIhhGi86Vr81HPJ-EGLYdOIvBw_fomYRp-iQZAFE3OENGdUhj4VU6EbZurJhFvxZ/pub?w=281&amp;h=311" class="figure-img img-fluid" alt="E. coli's chemotaxis, a sequence of runs and tumbles" />
  </a>
  
    <figcaption class="figure-caption text-center">
      Figure 1: E. coli's chemotaxis, a sequence of runs and tumbles
      
    </figcaption>
  
</figure>

<div class="modal align-items-center show" id="figureModal1" tabindex="-1">

  <div class="text-right fixed-top">
    <button type="button" class="close" data-dismiss="modal" aria-label="Fermer">
      <i class="fas fa-times-circle fa-2x" style="margin: 20px"></i>
    </button>
    <!-- <button type="button" class="close" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button> -->
  </div>

  <div class="modal-body vertically-centered">
    <figure class="figure text-center">
      <img src="https://docs.google.com/drawings/d/e/2PACX-1vQnPoOyX5pvzlugkIhhGi86Vr81HPJ-EGLYdOIvBw_fomYRp-iQZAFE3OENGdUhj4VU6EbZurJhFvxZ/pub?w=281&amp;h=311" class="figure-img img-fluid" alt="E. coli's chemotaxis, a sequence of runs and tumbles" style="max-height: 90vh; max-width: 90%;" />
      
        <figcaption class="figure-caption text-center">
          Figure 1: E. coli's chemotaxis, a sequence of runs and tumbles
        </figcaption>
      
    </figure>
  </div>
</div>

<p>A bacterium’s genome is fully represented by a Q-table: given an observation, the Q-table tells the bacterium which of the two actions should lead to the better future. Throughout the agent’s life, its genome is subject to random mutations, and some genetic material can be exchanged with other agents that are in close proximity.</p>

<p>At each time step, the bacteria lose some of their energy unless they are close to a food source that moves around the environment.</p>

<figure class="figure ided text-center" id="figure2">
  <div id="carousel2" class="carousel slide" data-ride="carousel">

    <ol class="carousel-indicators">
      
        <li data-target="#carousel2" data-slide-to="0" class="active"></li>
      
        <li data-target="#carousel2" data-slide-to="1"></li>
      
        <li data-target="#carousel2" data-slide-to="2"></li>
      
        <li data-target="#carousel2" data-slide-to="3"></li>
      
        <li data-target="#carousel2" data-slide-to="4"></li>
      
    </ol>

    <div class="carousel-inner">
      
        <div class="carousel-item active">
          <img src="/assets/images/rl/sourdough/00000.png" class="d-block w-100" />
          <figcaption class="figure-subcaption text-center">
            
            a) The genome is chosen randomly at the beginning
          </figcaption>
        </div>
      
        <div class="carousel-item">
          <img src="/assets/images/rl/sourdough/00003.png" class="d-block w-100" />
          <figcaption class="figure-subcaption text-center">
            
            b) The energy of bacteria far from the food source is quicly depleted...
          </figcaption>
        </div>
      
        <div class="carousel-item">
          <img src="/assets/images/rl/sourdough/00053.png" class="d-block w-100" />
          <figcaption class="figure-subcaption text-center">
            
            c) ...and the population collapses
          </figcaption>
        </div>
      
        <div class="carousel-item">
          <img src="/assets/images/rl/sourdough/00270.png" class="d-block w-100" />
          <figcaption class="figure-subcaption text-center">
            
            d) The variability in the genome falls
          </figcaption>
        </div>
      
        <div class="carousel-item">
          <img src="/assets/images/rl/sourdough/00597.png" class="d-block w-100" />
          <figcaption class="figure-subcaption text-center">
            
            e) The most efficient genome quickly takes over the entire population
          </figcaption>
        </div>
      
    </div>

    <a class="carousel-control-prev" href="#carousel2" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carousel2" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>

  
    <figcaption class="figure-caption text-center">
      Figure 2: Survival of the fittest...
      
    </figcaption>
  
</figure>

<p><a href="#figure2" class="ref">Figure 2</a>
 shows the state of the simulation at different generations. In the first iterations, the population collapses rapidly as most bacteria start very far from the food source. The Q-tables, shown on the top right corner, illustrate that as the population gets decimated, the genome becomes more uniform: only the bacteria equipped to seek out food survive.</p>

<p>After around 500 generations, the genome stabilises and the population skyrockets: the evolution process has selected a genome that fits “life” well.</p>

<p>Note that although we’ve used reinforcement learning concepts such as the <em>Q-table</em>, at no point did we perform RL. Rather, we let a purely evolutionary strategy roll out in an environment applying selective pressure on mutating agents.
<!-- We could add environmental pressure on the bacteria, for example by speeding up the movement of the food source. --></p>

<h2 id="what-are-they-optimising">What are they optimising?</h2>

<p>Contrary to other evolutionary strategies that define a <em>fitness</em> function used to compare individuals within a generation to decide which part of the population survives (or reproduces itself), we’ve let the environment resolve an implicit objective.</p>

<p>Understanding what objective the colony is optimising as a whole is very much a reverse reinforcement learning problem: the evolution has provided us with a Q-table and we want to know the reward function the value function optimises.</p>

<p>Following Blaise Aguera’s insight, we’ll try to answer this question using a surrogate problem. Rather than equating the bacterium’s genome with its Q-table, we will define it through a reward function that, unlike in the previous simulation, the agent will optimise for. In other words, each bacterium aims to solve an RL problem explicitly defined by its individual reward function.</p>

<p>This is a major shift in perspective. The environment will now apply selective pressure on the reward function itself, which will let us see what the fittest bacteria optimise for.</p>

<p>Recall the Q-learning algorithm:</p>

<div class="equation">
  \begin{equation}
    
v(s, a) = R(s, a) + \gamma \max_{a'} v(s', a'),

  \end{equation}
</div>

<p>where $s$, $a$ denote states and actions, $R$ is the reward function. $s’$ is the observed state when the agent chose action $a$ while in state $s$.</p>

<h2 id="about-the-name">About the name</h2>

<p>Invented in 1970 by British mathematician John Horton Conway, the <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Game of Life</a> aims to simulate the evolution of a colony of cells using very basic rules, leading to patterns of incredible complexity.</p>

<figure class="figure ided text-center" id="figure3">
  <a data-toggle="modal" data-target="#figureModal3">
  <img src="https://upload.wikimedia.org/wikipedia/commons/e/e5/Gospers_glider_gun.gif" class="figure-img img-fluid" alt="A single Gosper's glider gun creating gliders (Wikipedia)" />
  </a>
  
    <figcaption class="figure-caption text-center">
      Figure 3: A single Gosper's glider gun creating gliders (Wikipedia)
      
    </figcaption>
  
</figure>

<div class="modal align-items-center show" id="figureModal3" tabindex="-1">

  <div class="text-right fixed-top">
    <button type="button" class="close" data-dismiss="modal" aria-label="Fermer">
      <i class="fas fa-times-circle fa-2x" style="margin: 20px"></i>
    </button>
    <!-- <button type="button" class="close" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button> -->
  </div>

  <div class="modal-body vertically-centered">
    <figure class="figure text-center">
      <img src="https://upload.wikimedia.org/wikipedia/commons/e/e5/Gospers_glider_gun.gif" class="figure-img img-fluid" alt="A single Gosper's glider gun creating gliders (Wikipedia)" style="max-height: 90vh; max-width: 90%;" />
      
        <figcaption class="figure-caption text-center">
          Figure 3: A single Gosper's glider gun creating gliders (Wikipedia)
        </figcaption>
      
    </figure>
  </div>
</div>

<p><a href="#figure3" class="ref">Figure 3</a>
 provides an example of such complex pattern: it shows a “glider gun”, a periodic structure shooting out <em>gliders</em> –small units that translate themselves across the grid.</p>

	</div>

	

	



</article>
</section>
	</div>

	<div class="col-12 col-lg-2"></div>

</div>


		</div>

		<footer>
  <div class="container">
    <hr>

    <div class="pdf-link">
      <a href="/assets/files/Basile%20Dura%20Resume.pdf">My résumé</a>
    </div>

    &copy; Basile Dura  2021. Adapted from a theme by
    <a href="https://github.com/CloudCannon/treat-jekyll-template" target="_blank" rel="noopener">CloudCannon</a>.

    <div class="language-switch">
      
        
          <a href="#" class="active">en</a>
        
        
            •
        
      
        
          
            <a href="/fr/2020/07/07/playing-the-game-of-life/">fr</a>
          
        
        
      
    </div>


  </div>
</footer>


		<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

		<script crossorigin="anonymous" src="https://kit.fontawesome.com/f762d0327c.js"></script>
	</body>
</html>
