<!doctype html>

<html lang="en">

	<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Basile Dura — Meta-learning for drug discovery</title>

  
    <meta name="description" content="Basile Dura's personal page... A patchwork of projects revolving around artificial intelligence." />
  

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <!-- bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <!-- CSS -->
  <link href="//fonts.googleapis.com/css?family=Antic+Slab|Fira+Sans" rel="stylesheet">
  <link rel="stylesheet" media="screen" href="/assets/css/screen.css">

  

  <!-- Icon -->
  <link rel="icon" type="image/png" href="/assets/images/favicon.png">

  <!-- Prism -->
  <link rel="stylesheet"
      href="/assets/css/prism.css">
  <script src="/assets/js/prism.js"></script>

  <!-- MathJax -->
  <script>
    MathJax = {
        tex: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            processEscapes: true,
            processEnvironments: true,
        }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3.0.0/es5/tex-chtml.js"
          integrity="sha256-3Fdoa5wQb+JYfEmTpQHx9sc/GuwpfC/0R9EpBki+mf8=" crossorigin>
  </script>

  <!-- Pseudocode -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
  <script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js">
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-172908572-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-172908572-1');
  </script>

</head>


	<body>

		<div style="display:none">
  
  $$
  \usepackage{algorithm}
  \usepackage{algorithmic}

  \newcommand{\indic}{\mathbbm{1}}

  \newcommand{\argmax}{\operatorname*{arg\,max}}
  \newcommand{\argmin}{\operatorname*{arg\,min}}
  \newcommand{\norm}[1]{\left\lVert#1\right\rVert}

  \newcommand{\Var}{\mathbb{V}\textrm{ar}}
  \newcommand{\Cov}{\mathbb{C}\textrm{ov}}

  \newcommand{\Id}{\bm{\textrm{Id}}}

  \newcommand{\E}{\mathbb{E}}
  \newcommand{\R}{\mathbb{R}}
  \newcommand{\N}{\mathbb{N}}
  \newcommand{\C}{\mathbb{C}}
  \newcommand{\Q}{\mathbb{Q}}
  \newcommand{\Z}{\mathbb{Z}}

  \newcommand{\LP}{\left(}
  \newcommand{\RP}{\right)}
  \newcommand{\LB}{\left[}
  \newcommand{\RB}{\right]}
  \newcommand{\LC}{\left\{}
  \newcommand{\RC}{\right\}}
  \newcommand{\RM}{\right|}
  \newcommand{\LM}{\left|}
  \newcommand{\MM}{\middle|}

  \renewcommand{\P}{\mathbb{P}}

  \newcommand{\define}{\stackrel{\mathrm{def}}{=}}
  \newcommand{\iid}{\stackrel{\mathrm{iid}}{\sim}}

  \newcommand{\rfrac}[2]{{}^{#1}\!/_{#2}}

  \newcommand{\pderiv}[2]{\frac{\partial #1}{\partial #2}}

  \newenvironment{theorem}[2][Theorem]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{lemma}[2][Lemma]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{exercise}[2][Exercise]{
  \begin{trivlist}\pdfbookmark{#1 #2}{#1-#2}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}\vspace{5mm}}
  \newenvironment{question}[2][Question]{
  \begin{trivlist}\pdfbookmark{#1 #2}{#1-#2}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}\vspace{5mm}}
  \newenvironment{reflection}[2][Reflection]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{proposition}[2][Proposition]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}
  \newenvironment{corollary}[2][Corollary]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

  % Integral 'd'
  \def\diff{{\mathrm{d}}}

  % Vectors
  \def\vzero{{\bm{0}}}
  \def\vone{{\bm{1}}}
  \def\vmu{{\bm{\mu}}}
  \def\vtheta{{\bm{\theta}}}
  \def\va{{\bm{a}}}
  \def\vb{{\bm{b}}}
  \def\vc{{\bm{c}}}
  \def\vd{{\bm{d}}}
  \def\ve{{\bm{e}}}
  \def\vf{{\bm{f}}}
  \def\vg{{\bm{g}}}
  \def\vh{{\bm{h}}}
  \def\vi{{\bm{i}}}
  \def\vj{{\bm{j}}}
  \def\vk{{\bm{k}}}
  \def\vl{{\bm{l}}}
  \def\vm{{\bm{m}}}
  \def\vn{{\bm{n}}}
  \def\vo{{\bm{o}}}
  \def\vp{{\bm{p}}}
  \def\vq{{\bm{q}}}
  \def\vr{{\bm{r}}}
  \def\vs{{\bm{s}}}
  \def\vt{{\bm{t}}}
  \def\vu{{\bm{u}}}
  \def\vv{{\bm{v}}}
  \def\vw{{\bm{w}}}
  \def\vx{{\bm{x}}}
  \def\vy{{\bm{y}}}
  \def\vz{{\bm{z}}}

  % Matrix
  \def\mA{{\bm{A}}}
  \def\mB{{\bm{B}}}
  \def\mC{{\bm{C}}}
  \def\mD{{\bm{D}}}
  \def\mE{{\bm{E}}}
  \def\mF{{\bm{F}}}
  \def\mG{{\bm{G}}}
  \def\mH{{\bm{H}}}
  \def\mI{{\bm{I}}}
  \def\mJ{{\bm{J}}}
  \def\mK{{\bm{K}}}
  \def\mL{{\bm{L}}}
  \def\mM{{\bm{M}}}
  \def\mN{{\bm{N}}}
  \def\mO{{\bm{O}}}
  \def\mP{{\bm{P}}}
  \def\mQ{{\bm{Q}}}
  \def\mR{{\bm{R}}}
  \def\mS{{\bm{S}}}
  \def\mT{{\bm{T}}}
  \def\mU{{\bm{U}}}
  \def\mV{{\bm{V}}}
  \def\mW{{\bm{W}}}
  \def\mX{{\bm{X}}}
  \def\mY{{\bm{Y}}}
  \def\mZ{{\bm{Z}}}
  \def\mBeta{{\bm{\beta}}}
  \def\mPhi{{\bm{\Phi}}}
  \def\mLambda{{\bm{\Lambda}}}
  \def\mSigma{{\bm{\Sigma}}}

  % Caligraphy
  \def\calA{{\mathcal{A}}}
  \def\calB{{\mathcal{B}}}
  \def\calC{{\mathcal{C}}}
  \def\calD{{\mathcal{D}}}
  \def\calE{{\mathcal{E}}}
  \def\calF{{\mathcal{F}}}
  \def\calG{{\mathcal{G}}}
  \def\calH{{\mathcal{H}}}
  \def\calI{{\mathcal{I}}}
  \def\calJ{{\mathcal{J}}}
  \def\calK{{\mathcal{K}}}
  \def\calL{{\mathcal{L}}}
  \def\calM{{\mathcal{M}}}
  \def\calN{{\mathcal{N}}}
  \def\calO{{\mathcal{O}}}
  \def\calP{{\mathcal{P}}}
  \def\calQ{{\mathcal{Q}}}
  \def\calR{{\mathcal{R}}}
  \def\calS{{\mathcal{S}}}
  \def\calT{{\mathcal{T}}}
  \def\calU{{\mathcal{U}}}
  \def\calV{{\mathcal{V}}}
  \def\calW{{\mathcal{W}}}
  \def\calX{{\mathcal{X}}}
  \def\calY{{\mathcal{Y}}}
  \def\calZ{{\mathcal{Z}}}

  \def\normal{{\mathcal{N}}}

  \newcommand{\Dtrain}{{D_{\mathrm{train}}}}
  \newcommand{\Dvalid}{{D_{\mathrm{valid}}}}
  \newcommand{\Dtest}{{D_{\mathrm{test}}}}

  \newcommand{\Dtraint}{{D_{\mathrm{train}}^t}}
  \newcommand{\Dvalidt}{{D_{\mathrm{valid}}^t}}
  \newcommand{\Dtestt}{{D_{\mathrm{test}}^t}}

  \newcommand{\Dmeta}{{\mathcal{D}^\mathrm{meta}}}
  \newcommand{\Dmtrain}{{\mathcal{D}_\mathrm{train}^\mathrm{meta}}}
  \newcommand{\Dmvalid}{{\mathcal{D}_\mathrm{valid}^\mathrm{meta}}}
  \newcommand{\Dmtest}{{\mathcal{D}_\mathrm{test}^\mathrm{meta}}}

  \newcommand{\Dsupport}{{D_{\mathrm{support}}^t}}
  \newcommand{\Dquery}{{D_{\mathrm{query}}^t}}

  \newcommand{\loss}{\ell}
  \newcommand{\metaloss}{\mathcal{L}}

  \newcommand{\kr}{\mathrm{KR}}
  \newcommand{\kernel}{\mathrm{k}}
  \newcommand{\km}{\mathbf{K}}
  $$
  
</div>


		<nav>
	
	

		
		<a href="


  

/
" class="">
			Home
		</a>
	
	

		
		<a href="


  

/themes/
" class="">
			Themes
		</a>
	
	

		
		<a href="


  

/about/
" class="">
			About
		</a>
	

	<!-- 
		

		

		<a href="
			
				https://courses.bdura.me
			
		" class="">
			Courses
		</a>
	
		

		

		<a href="
			
				https://recettes.bdura.me/en/
			
		" class="">
			Recipes
		</a>
	 -->

	<div class="dropdown">
  <a class=" dropdown-toggle" type="button" id="dropdownMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Other
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdownMenu">
		
			

			

			<a href="
				
					https://courses.bdura.me
				
			" class="dropdown-item ">
				Courses
			</a>
		
			

			

			<a href="
				
					https://recettes.bdura.me/en/
				
			" class="dropdown-item ">
				Recipes
			</a>
		
  </div>
</div>

</nav>


		<div class="container main-content">

			<!-- <header>
	<div class="text-center">
		<a href="">
			<img src="/assets/images/author.png" alt="logo" style="border-radius: 50%;">
		</a>
	</div>
</header> -->

<div class="row">
	<div class="col-12 col-lg-2"></div>

	<div class="col-12 col-lg-8">
		<section class="content">



<article class="post">

	<div class="post-header">
	<h1>
		<a href="/2020/02/29/meta-learning-for-drug-discovery/">
			Meta-learning for drug discovery
		</a>
	</h1>
	<time datetime="2020-02-29 00:00:00 +0000">
		<!-- February 29, 2020 -->
		February 29, 2020
	</time>
</div>


	<div class="image">
		<img src="https://source.unsplash.com/0tfz7ZoXaWc" alt="Meta-learning for drug discovery" class="img-fluid">
	</div>

	<div class="post-body">
		<p>This post presents the report I wrote to finalise an internship at <a href="https://invivoai.com/">InVivo AI</a>, a Montréal-based startup aiming to bring few-shot learning to drug discovery.</p>

<p>You can find the full report <a href="/assets/files/Meta-learning for drug discovery.pdf">here</a>. It is divided into four parts:</p>

<ol>
  <li>
    <p>First, I give a succinct presentation of a typical drug discovery pipeline and discuss how machine-learning could help, as well as propose a set of desiderata for a drug-discovery algorithm.</p>
  </li>
  <li>
    <p>Then, I look at how traditional machine-learning has started to yield some results.</p>
  </li>
  <li>
    <p>Third, I argue that given the scarcity and noise of training data, the answer may lie in learning from multiple tasks and present a relatively new machine-learning paradigm, namely <em>meta-learning</em>.</p>
  </li>
  <li>
    <p>Finally, I describe one particular project that I worked on during the internship, namely “Adaptive Deep Kernel Learning”, a method we proposed to address the desiderata formulated to work with molecular data.</p>
  </li>
</ol>

<h2 id="drug-discovery">Drug discovery</h2>

<p>Drug discovery is the process of finding novel compounds apt to act on a specific target in order to stop, treat and cure a disease.</p>

<figure class="figure ided text-center" id="figure1">
  <a data-toggle="modal" data-target="#figureModal1">
  <img src="/assets/images/invivo/drug-discovery.jpg" class="figure-img img-fluid" alt="The traditional drug discovery pipeline" />
  </a>
  
    <figcaption class="figure-caption text-center">
      Figure 1: The traditional drug discovery pipeline
      <a class="citation" href="#janssen2019">(Janssen, 2019)</a>
    </figcaption>
  
</figure>

<div class="modal align-items-center show" id="figureModal1" tabindex="-1">

  <div class="text-right fixed-top">
    <button type="button" class="close" data-dismiss="modal" aria-label="Fermer">
      <i class="fas fa-times-circle fa-2x" style="margin: 20px"></i>
    </button>
  </div>

  <div class="modal-body vertically-centered">
    <figure class="figure text-center">
      <img src="/assets/images/invivo/drug-discovery.jpg" class="figure-img img-fluid" alt="The traditional drug discovery pipeline" />
      
        <figcaption class="figure-caption text-center">
          Figure 1: The traditional drug discovery pipeline
        </figcaption>
      
    </figure>
  </div>
</div>

<p>As <a href="#figure1" class="ref">figure 1</a>
 shows, the search begins with a long and tedious process of <em>in vitro</em> testing on as many as 10 000 to 15 000 candidate molecular compounds.</p>

<p>At the end of that step, which lasts three to six years, only a handful of compounds move on to the next phase. In many ways, this step is akin to looking for a needle in a haystack: although the process can be guided by some form of empirical knowledge, the latter is vastly insufficient to reduce the duration of the pre-clinical phase by any significant amount.</p>

<p>From there, another six to seven years of human clinical trials are necessary to validate the effects of the retained compounds.</p>

<h2 id="computational-drug-discovery">Computational drug discovery</h2>

<p>Computational drug discovery can be summarised into three distinct but coupled problems:</p>

<ol>
  <li>
    <p><strong>Scoring</strong>. “Scoring” a molecule, or estimating its properties, is the first building block of an artificial intelligence that can help discover new drugs.</p>
  </li>
  <li>
    <p><strong>Generation</strong>. There are an estimated 10<sup>60</sup> possible small molecules
<a class="citation" href="#chemicalspace">(Bohacek et al., 1996)</a>, while the largest molecular databases hold at most a hundred millions of them…</p>
  </li>
  <li>
    <p><strong>Optimisation</strong>. Combining a good generation strategy to efficiently explore the space of small molecules and an accurate scoring function, we may one day be able to optimise for compounds directly: given a set of desirable properties, the algorithm would propose candidates that are designed to perform best.</p>
  </li>
</ol>

<p>We can define a few desiderata for a good machine-learning algorithm for drug discovery :</p>
<ul>
  <li><strong>Representation</strong>, to get the most information.</li>
  <li><strong>Extrapolation</strong>, to be able to score significantly different compounds.</li>
  <li><strong>Data efficiency</strong>, given the dire scarcity of training examples.</li>
  <li><strong>Calibration</strong>, to be able to assess the level of confidence on the model’s predictions.</li>
</ul>

<h2 id="meta-learning">Meta-learning</h2>

<p>Note that the traditional machine-learning objective is in the form:</p>

<div class="equation">
  \begin{equation}
    
\argmin_\theta \metaloss (\Dtrain \mid \theta) = \argmin_\theta \E_{x, y \in \Dtrain} \LB \loss (y, f_\theta(x)_t) \RB

  \end{equation}
</div>

<p>where $\loss$ is the loss function, $f_\theta$ is the model parametrised by $\theta$, $x$ is the input and $y$ is the target.</p>

<p>A new range of algorithms has been developed in recent years in order to tackle the issue of generalising from very few examples. The paradigm, called meta-learning, aims at “learning to learn” from a collection of machine-learning problems that share a substantial amount of structure, by designing the objective function in such a way that the algorithm is explicitly trained to learn faster.</p>

<p>Instead of minimising the average loss on a set of individual examples, the meta-learning objective aims to minimise the average generalisation error on a set of training tasks. More formally, the meta-learning objective is in the form:</p>

<div class="equation">
  \begin{equation}
    
  \label{eq:maml}
  \argmin_\theta \E_{t \in \Dmtrain} \LB \metaloss (\Dquery \mid \theta, \Dsupport) \RB

  \end{equation}
</div>

<p>Where $t$ is a task from $\Dmtrain$, the <em>meta-training set</em>. Each task comes with <em>support</em> and <em>query</em> sets, corresponding to the training and validation sets in the traditional setting.</p>

<figure class="figure ided text-center" id="figure2">
  <a data-toggle="modal" data-target="#figureModal2">
  <img src="https://docs.google.com/drawings/d/e/2PACX-1vTmM4I87M3EzlrnEvEqAEfyj5qf4s-GhXqMORuEHkNENLijSotokbB0mmKlGpDtImGXv0xPMGsrpc__/pub?w=584&amp;h=537" class="figure-img img-fluid" alt="The meta-training loop" />
  </a>
  
    <figcaption class="figure-caption text-center">
      Figure 2: The meta-training loop
      
    </figcaption>
  
</figure>

<div class="modal align-items-center show" id="figureModal2" tabindex="-1">

  <div class="text-right fixed-top">
    <button type="button" class="close" data-dismiss="modal" aria-label="Fermer">
      <i class="fas fa-times-circle fa-2x" style="margin: 20px"></i>
    </button>
  </div>

  <div class="modal-body vertically-centered">
    <figure class="figure text-center">
      <img src="https://docs.google.com/drawings/d/e/2PACX-1vTmM4I87M3EzlrnEvEqAEfyj5qf4s-GhXqMORuEHkNENLijSotokbB0mmKlGpDtImGXv0xPMGsrpc__/pub?w=584&amp;h=537" class="figure-img img-fluid" alt="The meta-training loop" />
      
        <figcaption class="figure-caption text-center">
          Figure 2: The meta-training loop
        </figcaption>
      
    </figure>
  </div>
</div>


	</div>

	

	
		<h2>References</h2>

		<ol class="bibliography"><li><span id="janssen2019">Janssen. (2019). <i>Addressing The Challenges Of Drug Discovery</i>. Janssen. https://www.janssen.com/emea/drug-discovery</span></li>
<li><span id="chemicalspace">Bohacek, R. S., McMartin, C., &amp; Guida, W. C. (1996). The art and practice of structure-based drug design: A molecular modeling perspective. <i>Medicinal Research Reviews</i>, <i>16</i>(1), 3–50.</span></li></ol>
	



</article>
</section>
	</div>

	<div class="col-12 col-lg-2"></div>

</div>


		</div>

		<footer>
  <div class="container">
    <hr>

    <div class="pdf-link">
      <a href="/assets/files/Basile%20Dura%20Resume.pdf">My résumé</a>
    </div>

    &copy; Basile Dura  2020. Adapted from a theme by
    <a href="https://github.com/CloudCannon/treat-jekyll-template" target="_blank" rel="noopener">CloudCannon</a>.

    <div class="language-switch">
      
        
          <a href="#" class="active">en</a>
        
        
            •
        
      
        
          
            <a href="/fr/2020/02/29/meta-learning-for-drug-discovery/">fr</a>
          
        
        
      
    </div>


  </div>
</footer>


		<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

		<script crossorigin="anonymous" src="https://kit.fontawesome.com/f762d0327c.js"></script>
	</body>
</html>
